<!DOCTYPE html>
<html lang="en" style="height: 100%;width: 100%">
<head style="width: 100%">
    <link href="https://cdn.staticfile.org/twitter-bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.staticfile.org/jquery/2.1.1/jquery.min.js"></script>
    <script src="https://cdn.staticfile.org/twitter-bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <nav class="navbar navbar-inverse navbar-static-top" role="navigation">
        <div class="navbar-header">
            <a class="navbar-brand" href="#">
                <span class="glyphicon glyphicon-fire"></span> Wildfire in Canada</a>
        </div>
        <div>
            <ul class="nav navbar-nav">
                <li><a href="Wildfire_Scattermap.html" id="scatter">Scatter Map</a></a></li>
                <li><a href="Wildfire_Heatmap.html" id="heat">Heat Map</a></li>
                <li class="active"><a href="#" id="wind">72H Wind</a></li>
            </ul>
        </div>
        <div style="margin-right: 1%">
            <form class="navbar-form navbar-right" role="search">
                <div class="form-group">
                    <select id="Year" class="form-control" title="Year">
                        <option>1980-1989</option>
                        <option>1990-1999</option>
                        <option>2000-2009</option>
                        <option>2010-2019</option>
                        <option selected>04/09</option>
                        <option>2018</option>
                        <option>2017</option>
                        <option>2016</option>
                        <option>2015</option>
                        <option>2014</option>
                        <option>2013</option>
                        <option>2012</option>
                        <option>2011</option>
                        <option>2011</option>
                        <option>2010</option>
                        <option>2009</option>
                        <option>2008</option>
                        <option>2007</option>
                        <option>2006</option>
                        <option>2005</option>
                        <option>2004</option>
                        <option>2003</option>
                        <option>2002</option>
                        <option>2001</option>
                        <option>2000</option>
                        <option>1999</option>
                        <option>1998</option>

                    </select>
                    <select id="Month" class="form-control" title="Month">

                        <option selected>All</option>
                        <option>Jan</option>
                        <option>Feb</option>
                        <option>Mar</option>
                        <option>Apr</option>
                        <option>May</option>
                        <option>Jun</option>
                        <option>Jul</option>
                        <option>Aug</option>
                        <option>Sep</option>
                        <option>Oct</option>
                        <option>Nov</option>
                        <option>Dec</option>
                    </select>
                    <div id="checkbox" class="input-group" data-toggle="popover" data-placement="bottom" data-trigger="hover" data-title="Ignore Small Fire" data-content="Check if you want to ignore small fire with burned area smaller than 200 HA.">
                            <span class="input-group-addon">
                            <input id="IgnoreSmallFire" type="checkbox"></span>
                        <input type="text" class="form-control" placeholder="Ignore Small Fire" readonly size="11px">
                    </div>
                </div>
                <button type="button" id="RetrieveBtn" class="btn btn-default"><span class="glyphicon glyphicon-cloud-download"></span>
                    Retrieve Map</button>
            </form>
        </div>
    </nav>
    <style>
        body{
            max-width:100%;
        }
        .navbar-default{
            max-width:100%;
        }
    </style>
</head>
<body style="height: 100%;width: 100%;overflow-x: hidden;overflow-y: hidden">

<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/echarts@5/dist/echarts.min.js"></script>
<!-- Uncomment this line if you want to dataTool extension
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/echarts@5/dist/extension/dataTool.min.js"></script>
-->
<!-- Uncomment this line if you want to use gl extension-->
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/echarts-gl@2/dist/echarts-gl.min.js"></script>
<!-- Uncomment this line if you want to echarts-stat extension
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/echarts-stat@latest/dist/ecStat.min.js"></script>
-->
<!-- Uncomment this line if you want to use map
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/echarts@5/map/js/china.js"></script>
-->
<script type="text/javascript" src="https://github.com/apache/echarts/blob/master/test/data/map/js/world.js"></script>

<script type="text/javascript" src="https://api.map.baidu.com/api?v=2.0&ak=5gHi9u8TiBqQbFy0tVR2wNWVIoOsWGtP"></script>
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/echarts@5/dist/extension/bmap.min.js"></script>

<style type="text/css">
    .navbar { margin-bottom: 0}
</style>

<div id="container" style="height: 100%;margin-bottom: 0;position: relative;z-index: 1"></div>

<script type="text/javascript">
    function getData(day, time) {
        day = 9;
        time = 0;
        data = [];
        maxMag = 0;
        minMag = Infinity;

        $.ajax({
            type: "GET",
            async: false,
            url: "http://localhost:8443/getWindTime?Day=" + day + "&Time=" + time,
            dataType: "json",
            success: function (res) {
                myChart.hideLoading();
                var records = res;
                var len = records.length;
                for (var i = 0; i < len; i++) {
                    var vx = records[i]['u'];
                    var vy = records[i]['v'];
                    var mag = Math.sqrt(vx * vx + vy * vy);
                    var lat = records[i]['latitude'];
                    if (lat >= 180) {
                        lat = 180 - lat-15;
                    }
                    data.push([lat, records[i]['longitude'], vx, vy, mag]);
                    maxMag = Math.max(mag, maxMag);
                    minMag = Math.min(mag, minMag);
                }
                if (len == 0) {
                    alert("There is no wind data to show in this time!");
                }
                return data
            }
        })
    }

    var minMag, maxMag;
    var data = [];
    var dom = document.getElementById("container");
    var myChart = echarts.init(dom);
    var option;
    getData();

    myChart.setOption(option = {
            visualMap: {
                left: 'right',
                min: minMag,
                max: maxMag,
                dimension: 4,
                inRange: {
                    // color: ['green', 'yellow', 'red']
                    color: ['#313695', '#4575b4', '#74add1', '#abd9e9', '#e0f3f8', '#ffffbf', '#fee090', '#fdae61', '#f46d43', '#d73027', '#a50026']
                },
                realtime: false,
                calculable: true,
                textStyle: {
                    color: '#fff'
                }
            },
            bmap: {
                center: [-98, 57.963],
                zoom: 5,
                roam: true,
                mapStyle: {
                    'styleJson': [
                        {
                            'featureType': 'water',
                            'elementType': 'all',
                            'stylers': {
                                'color': '#031628'
                            }
                        },
                        {
                            'featureType': 'land',
                            'elementType': 'geometry',
                            'stylers': {
                                'color': '#000102'
                            }
                        },
                        {
                            'featureType': 'highway',
                            'elementType': 'all',
                            'stylers': {
                                'visibility': 'off'
                            }
                        },
                        {
                            'featureType': 'arterial',
                            'elementType': 'geometry.fill',
                            'stylers': {
                                'color': '#000000'
                            }
                        },
                        {
                            'featureType': 'arterial',
                            'elementType': 'geometry.stroke',
                            'stylers': {
                                'color': '#0b3d51'
                            }
                        },
                        {
                            'featureType': 'local',
                            'elementType': 'geometry',
                            'stylers': {
                                'color': '#000000'
                            }
                        },
                        {
                            'featureType': 'railway',
                            'elementType': 'geometry.fill',
                            'stylers': {
                                'color': '#000000'
                            }
                        },
                        {
                            'featureType': 'railway',
                            'elementType': 'geometry.stroke',
                            'stylers': {
                                'color': '#08304b'
                            }
                        },
                        {
                            'featureType': 'subway',
                            'elementType': 'geometry',
                            'stylers': {
                                'lightness': -70
                            }
                        },
                        {
                            'featureType': 'building',
                            'elementType': 'geometry.fill',
                            'stylers': {
                                'color': '#000000'
                            }
                        },
                        {
                            'featureType': 'all',
                            'elementType': 'labels.text.fill',
                            'stylers': {
                                'color': '#857f7f'
                            }
                        },
                        {
                            'featureType': 'all',
                            'elementType': 'labels.text.stroke',
                            'stylers': {
                                'color': '#000000'
                            }
                        },
                        {
                            'featureType': 'building',
                            'elementType': 'geometry',
                            'stylers': {
                                'color': '#022338'
                            }
                        },
                        {
                            'featureType': 'green',
                            'elementType': 'geometry',
                            'stylers': {
                                'color': '#062032'
                            }
                        },
                        {
                            'featureType': 'boundary',
                            'elementType': 'all',
                            'stylers': {
                                'color': '#465b6c'
                            }
                        },
                        {
                            'featureType': 'manmade',
                            'elementType': 'all',
                            'stylers': {
                                'color': '#022338'
                            }
                        },
                        {
                            'featureType': 'label',
                            'elementType': 'all',
                            'stylers': {
                                'visibility': 'off'
                            }
                        }
                    ]
                }
            },
            series: [{
                type: 'flowGL',
                coordinateSystem: 'bmap',
                data: data,
                supersampling: 4,
                particleType: 'line',
                particleDensity: 64,
                particleSpeed: 0.8,
                // gridWidth: windData.nx,
                // gridHeight: windData.ny,
                itemStyle: {
                    opacity: 0.7
                }
            }]
        });
</script>

</body>
</html>